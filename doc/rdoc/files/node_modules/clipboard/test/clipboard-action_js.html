<!DOCTYPE html>
<html lang="en">
<head>
    <title>clipboard-action.js</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="../../../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../../css/github.css" type="text/css" media="screen" />
<script src="../../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>
    <div class="banner">
        
        <h1>
            clipboard-action.js
        </h1>
        <ul class="files">
            
            <li>
                node_modules/clipboard/test/clipboard-action.js
                
            </li>
            <li>Last modified: 2018-11-21 17:20:08 -0200</li>
        </ul>
    </div>

    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>import ClipboardAction from &#39;../src/clipboard-action&#39;; import
Emitter from &#39;tiny-emitter&#39;;</p>

<p>describe(&#39;ClipboardAction&#39;, () =&gt; {</p>

<pre><code>before(() =&gt; {
    global.input = document.createElement(&#39;input&#39;);
    global.input.setAttribute(&#39;id&#39;, &#39;input&#39;);
    global.input.setAttribute(&#39;value&#39;, &#39;abc&#39;);
    document.body.appendChild(global.input);

    global.paragraph = document.createElement(&#39;p&#39;);
    global.paragraph.setAttribute(&#39;id&#39;, &#39;paragraph&#39;);
    global.paragraph.textContent = &#39;abc&#39;;
    document.body.appendChild(global.paragraph);
});

after(() =&gt; {
    document.body.innerHTML = &#39;&#39;;
});

describe(&#39;#resolveOptions&#39;, () =&gt; {
    it(&#39;should set base properties&#39;, () =&gt; {
        let clip = new ClipboardAction({
            emitter: new Emitter(),
            container: document.body,
            text: &#39;foo&#39;
        });

        assert.property(clip, &#39;action&#39;);
        assert.property(clip, &#39;container&#39;);
        assert.property(clip, &#39;emitter&#39;);
        assert.property(clip, &#39;target&#39;);
        assert.property(clip, &#39;text&#39;);
        assert.property(clip, &#39;trigger&#39;);
        assert.property(clip, &#39;selectedText&#39;);
    });
});

describe(&#39;#initSelection&#39;, () =&gt; {
    it(&#39;should set the position right style property&#39;, done =&gt; {
        // Set document direction
        document.documentElement.setAttribute(&#39;dir&#39;, &#39;rtl&#39;);

        let clip = new ClipboardAction({
                emitter: new Emitter(),
                container: document.body,
                text: &#39;foo&#39;
            });

        assert.equal(clip.fakeElem.style.right, &#39;-9999px&#39;);
        done();
    });
});

describe(&#39;#set action&#39;, () =&gt; {
    it(&#39;should throw an error since &quot;action&quot; is invalid&#39;, done =&gt; {
        try {
            new ClipboardAction({
                text: &#39;foo&#39;,
                action: &#39;paste&#39;
            });
        }
        catch(e) {
            assert.equal(e.message, &#39;Invalid &quot;action&quot; value, use either &quot;copy&quot; or &quot;cut&quot;&#39;);
            done();
        }
    });
});

describe(&#39;#set target&#39;, () =&gt; {
    it(&#39;should throw an error since &quot;target&quot; do not match any element&#39;, done =&gt; {
        try {
            new ClipboardAction({
                target: document.querySelector(&#39;#foo&#39;)
            });
        }
        catch(e) {
            assert.equal(e.message, &#39;Invalid &quot;target&quot; value, use a valid Element&#39;);
            done();
        }
    });
});

describe(&#39;#selectText&#39;, () =&gt; {
    it(&#39;should create a fake element and select its value&#39;, () =&gt; {
        let clip = new ClipboardAction({
            emitter: new Emitter(),
            container: document.body,
            text: &#39;blah&#39;
        });

        assert.equal(clip.selectedText, clip.fakeElem.value);
    });
});

describe(&#39;#removeFake&#39;, () =&gt; {
    it(&#39;should remove a temporary fake element&#39;, () =&gt; {
        let clip = new ClipboardAction({
            emitter: new Emitter(),
            container: document.body,
            text: &#39;blah&#39;
        });

        clip.removeFake();

        assert.equal(clip.fakeElem, null);
    });
});

describe(&#39;#selectTarget&#39;, () =&gt; {
    it(&#39;should select text from editable element&#39;, () =&gt; {
        let clip = new ClipboardAction({
            emitter: new Emitter(),
            container: document.body,
            target: document.querySelector(&#39;#input&#39;)
        });

        assert.equal(clip.selectedText, clip.target.value);
    });

    it(&#39;should select text from non-editable element&#39;, () =&gt; {
        let clip = new ClipboardAction({
            emitter: new Emitter(),
            container: document.body,
            target: document.querySelector(&#39;#paragraph&#39;)
        });

        assert.equal(clip.selectedText, clip.target.textContent);
    });
});

describe(&#39;#copyText&#39;, () =&gt; {
    before(() =&gt; {
        global.stub = sinon.stub(document, &#39;execCommand&#39;);
    });

    after(() =&gt; {
        global.stub.restore();
    });

    it(&#39;should fire a success event on browsers that support copy command&#39;, done =&gt; {
        global.stub.returns(true);

        let emitter = new Emitter();

        emitter.on(&#39;success&#39;, () =&gt; {
            done();
        });

        let clip = new ClipboardAction({
            emitter,
            target: document.querySelector(&#39;#input&#39;)
        });
    });

    it(&#39;should fire an error event on browsers that support copy command&#39;, done =&gt; {
        global.stub.returns(false);

        let emitter = new Emitter();

        emitter.on(&#39;error&#39;, () =&gt; {
            done();
        });

        let clip = new ClipboardAction({
            emitter,
            target: document.querySelector(&#39;#input&#39;)
        });
    });
});

describe(&#39;#handleResult&#39;, () =&gt; {
    it(&#39;should fire a success event with certain properties&#39;, done =&gt; {
        let clip = new ClipboardAction({
            emitter: new Emitter(),
            container: document.body,
            target: document.querySelector(&#39;#input&#39;)
        });

        clip.emitter.on(&#39;success&#39;, (e) =&gt; {
            assert.property(e, &#39;action&#39;);
            assert.property(e, &#39;text&#39;);
            assert.property(e, &#39;trigger&#39;);
            assert.property(e, &#39;clearSelection&#39;);

            done();
        });

        clip.handleResult(true);
    });

    it(&#39;should fire a error event with certain properties&#39;, done =&gt; {
        let clip = new ClipboardAction({
            emitter: new Emitter(),
            container: document.body,
            target: document.querySelector(&#39;#input&#39;)
        });

        clip.emitter.on(&#39;error&#39;, (e) =&gt; {
            assert.property(e, &#39;action&#39;);
            assert.property(e, &#39;trigger&#39;);
            assert.property(e, &#39;clearSelection&#39;);

            done();
        });

        clip.handleResult(false);
    });
});

describe(&#39;#clearSelection&#39;, () =&gt; {
    it(&#39;should remove focus from target and text selection&#39;, () =&gt; {
        let clip = new ClipboardAction({
            emitter: new Emitter(),
            container: document.body,
            target: document.querySelector(&#39;#input&#39;)
        });

        clip.clearSelection();

        let selectedElem = document.activeElement;
        let selectedText = window.getSelection().toString();

        assert.equal(selectedElem, document.body);
        assert.equal(selectedText, &#39;&#39;);
    });
});

describe(&#39;#destroy&#39;, () =&gt; {
    it(&#39;should destroy an existing fake element&#39;, () =&gt; {
        let clip = new ClipboardAction({
            emitter: new Emitter(),
            container: document.body,
            text: &#39;blah&#39;
        });

        clip.selectFake();
        clip.destroy();

        assert.equal(clip.fakeElem, null);
    });
});
</code></pre>

<p>});</p>

    </div>
  


  


  
  


  


  

  



  

    

    

    


    


    <!-- Methods -->
    
    
    
  
</div>

    </div>
  </body>
</html>
