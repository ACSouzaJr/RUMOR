<!DOCTYPE html>
<html lang="en">
<head>
    <title>index.js</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="../../../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../../css/github.css" type="text/css" media="screen" />
<script src="../../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>
    <div class="banner">
        
        <h1>
            index.js
        </h1>
        <ul class="files">
            
            <li>
                node_modules/tiny-emitter/test/index.js
                
            </li>
            <li>Last modified: 2018-11-21 17:20:08 -0200</li>
        </ul>
    </div>

    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>var Emitter = require(&#39;../index&#39;); var emitter =
require(&#39;../instance&#39;); var test = require(&#39;tape&#39;);</p>

<p>test(&#39;subscribes to an event&#39;, function (t) {</p>

<pre><code>var emitter = new Emitter();
emitter.on(&#39;test&#39;, function () {});

t.equal(emitter.e.test.length, 1, &#39;subscribed to event&#39;);
t.end();
</code></pre>

<p>});</p>

<p>test(&#39;subscribes to an event with context&#39;, function (t) {</p>

<pre><code>var emitter = new Emitter();
var context = {
  contextValue: true
};

emitter.on(&#39;test&#39;, function () {
  t.ok(this.contextValue, &#39;is in context&#39;);
  t.end();
}, context);

emitter.emit(&#39;test&#39;);
</code></pre>

<p>});</p>

<p>test(&#39;subscibes only once to an event&#39;, function (t) {</p>

<pre><code>var emitter = new Emitter();

emitter.once(&#39;test&#39;, function () {
  t.notOk(emitter.e.test, &#39;removed event from list&#39;);
  t.end();
});

emitter.emit(&#39;test&#39;);
</code></pre>

<p>});</p>

<p>test(&#39;keeps context when subscribed only once&#39;, function (t) {</p>

<pre><code>var emitter = new Emitter();
var context = {
  contextValue: true
};

emitter.once(&#39;test&#39;, function () {
  t.ok(this.contextValue, &#39;is in context&#39;);
  t.notOk(emitter.e.test, &#39;not subscribed anymore&#39;);
  t.end();
}, context);

emitter.emit(&#39;test&#39;);
</code></pre>

<p>});</p>

<p>test(&#39;emits an event&#39;, function (t) {</p>

<pre><code>var emitter = new Emitter();

emitter.on(&#39;test&#39;, function () {
  t.ok(true, &#39;triggered event&#39;);
  t.end();
});

emitter.emit(&#39;test&#39;);
</code></pre>

<p>});</p>

<p>test(&#39;passes all arguments to event listener&#39;, function (t) {</p>

<pre><code>var emitter = new Emitter();

emitter.on(&#39;test&#39;, function (arg1, arg2) {
  t.equal(arg1, &#39;arg1&#39;, &#39;passed the first argument&#39;);
  t.equal(arg2, &#39;arg2&#39;, &#39;passed the second argument&#39;);
  t.end();
});

emitter.emit(&#39;test&#39;, &#39;arg1&#39;, &#39;arg2&#39;);
</code></pre>

<p>});</p>

<p>test(&#39;unsubscribes from all events with name&#39;, function (t) {</p>

<pre><code>var emitter = new Emitter();
emitter.on(&#39;test&#39;, function () {
  t.fail(&#39;should not get called&#39;);
});
emitter.off(&#39;test&#39;);
emitter.emit(&#39;test&#39;)

process.nextTick(function () {
  t.end();
});
</code></pre>

<p>});</p>

<p>test(&#39;unsubscribes single event with name and callback&#39;, function
(t) {</p>

<pre><code>var emitter = new Emitter();
var fn = function () {
  t.fail(&#39;should not get called&#39;);
}

emitter.on(&#39;test&#39;, fn);
emitter.off(&#39;test&#39;, fn);
emitter.emit(&#39;test&#39;)

process.nextTick(function () {
  t.end();
});
</code></pre>

<p>});</p>

<p>// Test added by <a href="https://github.com/lazd">github.com/lazd</a> //
From PR: <a
href="https://github.com/scottcorgan/tiny-emitter/pull/6">github.com/scottcorgan/tiny-emitter/pull/6</a>
test(&#39;unsubscribes single event with name and callback when subscribed
twice&#39;, function (t) {</p>

<pre><code>var emitter = new Emitter();
var fn = function () {
  t.fail(&#39;should not get called&#39;);
};

emitter.on(&#39;test&#39;, fn);
emitter.on(&#39;test&#39;, fn);

emitter.off(&#39;test&#39;, fn);
emitter.emit(&#39;test&#39;);

process.nextTick(function () {
  t.notOk(emitter.e[&#39;test&#39;], &#39;removes all events&#39;);
  t.end();
});
</code></pre>

<p>});</p>

<p>test(&#39;unsubscribes single event with name and callback when subscribed
twice out of order&#39;, function (t) {</p>

<pre><code>var emitter = new Emitter();
var calls = 0;
var fn = function () {
  t.fail(&#39;should not get called&#39;);
};
var fn2 = function () {
  calls++;
};

emitter.on(&#39;test&#39;, fn);
emitter.on(&#39;test&#39;, fn2);
emitter.on(&#39;test&#39;, fn);
emitter.off(&#39;test&#39;, fn);
emitter.emit(&#39;test&#39;);

process.nextTick(function () {
  t.equal(calls, 1, &#39;callback was called&#39;);
  t.end();
});
</code></pre>

<p>});</p>

<p>test(&#39;removes an event inside another event&#39;, function (t) {</p>

<pre><code>var emitter = new Emitter();

emitter.on(&#39;test&#39;, function () {
  t.equal(emitter.e.test.length, 1, &#39;event is still in list&#39;);

  emitter.off(&#39;test&#39;);

  t.notOk(emitter.e.test, 0, &#39;event is gone from list&#39;);
  t.end();
});

emitter.emit(&#39;test&#39;);
</code></pre>

<p>});</p>

<p>test(&#39;event is emitted even if unsubscribed in the event callback&#39;,
function (t) {</p>

<pre><code>var emitter = new Emitter();
var calls = 0;
var fn = function () {
  calls += 1;
  emitter.off(&#39;test&#39;, fn);
};

emitter.on(&#39;test&#39;, fn);

emitter.on(&#39;test&#39;, function () {
  calls += 1;
});

emitter.on(&#39;test&#39;, function () {
  calls += 1;
});

process.nextTick(function () {
  t.equal(calls, 3, &#39;all callbacks were called&#39;);
  t.end();
});

emitter.emit(&#39;test&#39;);
</code></pre>

<p>});</p>

<p>test(&#39;calling off before any events added does nothing&#39;, function
(t) {</p>

<pre><code>var emitter = new Emitter();
emitter.off(&#39;test&#39;, function () {});
t.end();
</code></pre>

<p>});</p>

<p>test(&#39;emitting event that has not been subscribed to yet&#39;, function
(t) {</p>

<pre><code>var emitter = new Emitter();

emitter.emit(&#39;some-event&#39;, &#39;some message&#39;);
t.end();
</code></pre>

<p>});</p>

<p>test(&#39;unsubscribes single event with name and callback which was
subscribed once&#39;, function (t) {</p>

<pre><code>var emitter = new Emitter();
var fn = function () {
  t.fail(&#39;event not unsubscribed&#39;);
}

emitter.once(&#39;test&#39;, fn);
emitter.off(&#39;test&#39;, fn);
emitter.emit(&#39;test&#39;);

t.end();
</code></pre>

<p>});</p>

<p>test(&#39;exports an instance&#39;, function (t) {</p>

<pre><code>t.ok(emitter, &#39;exports an instance&#39;)
t.ok(emitter instanceof Emitter, &#39;an instance of the Emitter class&#39;);
t.end();
</code></pre>

<p>});</p>

    </div>
  


  


  
  


  


  

  



  

    

    

    


    


    <!-- Methods -->
    
    
    
  
</div>

    </div>
  </body>
</html>
